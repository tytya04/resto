# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∑–∞–∫—É–ø–æ–∫ –¥–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
3. [–≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏](#—ç—Ç–∞–ø—ã-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
   - [–≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—ç—Ç–∞–ø-1-–±–∞–∑–æ–≤–∞—è-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
   - [–≠—Ç–∞–ø 2: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite](#—ç—Ç–∞–ø-2-–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö-sqlite)
   - [–≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Sheets](#—ç—Ç–∞–ø-3-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-google-sheets)
   - [–≠—Ç–∞–ø 4: –°–∏—Å—Ç–µ–º–∞ —É–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤](#—ç—Ç–∞–ø-4-—Å–∏—Å—Ç–µ–º–∞-—É–º–Ω–æ–≥–æ-–ø–æ–∏—Å–∫–∞-–ø—Ä–æ–¥—É–∫—Ç–æ–≤)
   - [–≠—Ç–∞–ø 5: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è](#—ç—Ç–∞–ø-5-—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è-–∏-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
   - [–≠—Ç–∞–ø 6: –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫](#—ç—Ç–∞–ø-6-—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ-–∑–∞—è–≤–æ–∫)
   - [–≠—Ç–∞–ø 7: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–æ–∫](#—ç—Ç–∞–ø-7-–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è-–æ—Ç–ø—Ä–∞–≤–∫–∞-–∑–∞—è–≤–æ–∫)
   - [–≠—Ç–∞–ø 8: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–µ–Ω–µ–¥–∂–µ—Ä–∞](#—ç—Ç–∞–ø-8-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å-–º–µ–Ω–µ–¥–∂–µ—Ä–∞)
   - [–≠—Ç–∞–ø 9: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤](#—ç—Ç–∞–ø-9-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è-–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
   - [–≠—Ç–∞–ø 10: –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –∑–∞–∫—É–ø—â–∏–∫–æ–≤](#—ç—Ç–∞–ø-10-–∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è-–∑–∞–∫–∞–∑–æ–≤-–¥–ª—è-–∑–∞–∫—É–ø—â–∏–∫–æ–≤)
   - [–≠—Ç–∞–ø 11: –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω–∞–º–∏ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å](#—ç—Ç–∞–ø-11-—Å–∏—Å—Ç–µ–º–∞-—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è-—Ü–µ–Ω–∞–º–∏-–∏-–æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å)
   - [–≠—Ç–∞–ø 12: Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è](#—ç—Ç–∞–ø-12-email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
   - [–≠—Ç–∞–ø 13: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å](#—ç—Ç–∞–ø-13-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è-–ø–∞–Ω–µ–ª—å)
   - [–≠—Ç–∞–ø 14: –°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#—ç—Ç–∞–ø-14-—Å–∏—Å—Ç–µ–º–∞-–æ–±—Ä–∞–±–æ—Ç–∫–∏-–æ—à–∏–±–æ–∫-–∏-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
4. [API –∏ –∫–æ–º–∞–Ω–¥—ã](#api-–∏-–∫–æ–º–∞–Ω–¥—ã)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∏-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
6. [–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã](#–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ-—Å–∏—Å—Ç–µ–º—ã)

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

Telegram –±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫—É–ø–∫–∞–º–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —É—á–µ—Ç–∞ –∑–∞—è–≤–æ–∫ –Ω–∞ –ø–æ—Å—Ç–∞–≤–∫—É –ø—Ä–æ–¥—É–∫—Ç–æ–≤.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- üè¢ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º–∏
- üë• –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å (—Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã, –º–µ–Ω–µ–¥–∂–µ—Ä—ã, –∑–∞–∫—É–ø—â–∏–∫–∏)
- üìã –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–æ–∫
- üîç –£–º–Ω—ã–π –ø–æ–∏—Å–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏–µ–π
- üìä –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Sheets –¥–ª—è –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã
- ‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–æ–∫ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- üíº –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–æ–∫ –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏ —Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ü–µ–Ω
- üõí –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –∑–∞–∫—É–ø—â–∏–∫–æ–≤ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º
- üìÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¢–û–†–ì-12
- üìß Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:
- **Node.js** - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞
- **Telegraf** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram Bot API
- **SQLite + Sequelize** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ ORM
- **Google Sheets API** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–æ–π
- **Puppeteer** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PDF
- **Node-cron** - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
- **Fuse.js** - –Ω–µ—á–µ—Ç–∫–∏–π –ø–æ–∏—Å–∫
- **Winston** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Nodemailer** - –æ—Ç–ø—Ä–∞–≤–∫–∞ email
- **Handlebars** - —à–∞–±–ª–æ–Ω–∏–∑–∞—Ü–∏—è –ø–∏—Å–µ–º

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:
```
restaurant-procurement-bot/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ config/           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ database/         # –ú–æ–¥–µ–ª–∏ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ handlers/         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/      # Middleware (auth, logging)
‚îÇ   ‚îú‚îÄ‚îÄ scenes/           # –°—Ü–µ–Ω—ã Telegraf
‚îÇ   ‚îú‚îÄ‚îÄ services/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ templates/        # –®–∞–±–ª–æ–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –ø–∏—Å–µ–º
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ email/        # Email —à–∞–±–ª–æ–Ω—ã (Handlebars)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ documents/    # HTML —à–∞–±–ª–æ–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ utils/            # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ documents/            # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ logs/                 # –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .env                  # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ index.js              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îî‚îÄ‚îÄ package.json          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## –≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è Telegram –±–æ—Ç–∞ –Ω–∞ Node.js.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤:
```
src/
‚îú‚îÄ‚îÄ config/           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ handlers/         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ middlewares/      # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îú‚îÄ‚îÄ models/           # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ services/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ utils/            # –£—Ç–∏–ª–∏—Ç—ã
‚îî‚îÄ‚îÄ constants/        # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **index.js** - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```javascript
const bot = new Telegraf(config.botToken);
bot.use(loggerMiddleware);
bot.use(authMiddleware);
```

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (winston)**
```javascript
const logger = winston.createLogger({
  level: config.logLevel,
  format: winston.format.json(),
  transports: [
    new winston.transports.File({ filename: 'logs/error.log', level: 'error' }),
    new winston.transports.File({ filename: 'logs/combined.log' })
  ]
});
```

3. **Middleware –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**
```javascript
const loggerMiddleware = async (ctx, next) => {
  const start = Date.now();
  await next();
  const ms = Date.now() - start;
  logger.info(`${ctx.updateType} - ${ms}ms`);
};
```

### –≠—Ç–∞–ø 2: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite

**–ó–∞–¥–∞—á–∞:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö SQLite —Å Sequelize ORM.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö:

1. **User** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
```javascript
{
  telegram_id: STRING(50),
  username: STRING(100),
  role: ENUM('restaurant', 'manager', 'buyer', 'admin'),
  restaurant_id: INTEGER,
  is_active: BOOLEAN
}
```

2. **Restaurant** - —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã
```javascript
{
  name: STRING(200),
  legal_name: STRING(300),
  inn: STRING(12),
  kpp: STRING(9),
  address: TEXT,
  bank_details: JSON
}
```

3. **Order** - –∑–∞–∫–∞–∑—ã
```javascript
{
  order_number: STRING(20),
  restaurant_id: INTEGER,
  user_id: INTEGER,
  status: ENUM('draft', 'sent', 'processing', 'approved', 'rejected'),
  total_amount: DECIMAL(10, 2),
  notes: TEXT
}
```

4. **OrderItem** - –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫–∞–∑–∞
```javascript
{
  order_id: INTEGER,
  product_name: STRING(300),
  quantity: DECIMAL(10, 3),
  unit: STRING(20),
  price: DECIMAL(10, 2),
  total: DECIMAL(10, 2)
}
```

5. **NomenclatureCache** - –∫—ç—à –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã
```javascript
{
  product_name: STRING(300),
  category: STRING(100),
  unit: STRING(20),
  price: DECIMAL(10, 2)
}
```

6. **ProductSynonym** - —Å–∏–Ω–æ–Ω–∏–º—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤
```javascript
{
  synonym: STRING(300),
  product_name: STRING(300),
  usage_count: INTEGER
}
```

#### –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏:
- User ‚Üí Restaurant (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)
- Order ‚Üí Restaurant (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)
- Order ‚Üí User (–º–Ω–æ–≥–∏–µ –∫ –æ–¥–Ω–æ–º—É)
- Order ‚Üí OrderItem (–æ–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º)

### –≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Sheets

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Google Sheets API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### GoogleSheetsService:
```javascript
class GoogleSheetsService {
  async initialize() {
    // –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Service Account
    const auth = new google.auth.JWT(
      serviceAccountEmail,
      null,
      privateKey,
      ['https://www.googleapis.com/auth/spreadsheets.readonly']
    );
  }

  async fetchNomenclature() {
    // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
    const response = await sheets.spreadsheets.values.get({
      spreadsheetId,
      range
    });
  }

  async updateCache() {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫—ç—à–∞
    await NomenclatureCache.bulkCreate(products);
  }
}
```

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Service Account
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (cron)
- ‚úÖ –†–∞–±–æ—Ç–∞ –≤ –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API

### –≠—Ç–∞–ø 4: –°–∏—Å—Ç–µ–º–∞ —É–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤

**–ó–∞–¥–∞—á–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —É–º–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å –∞–≤—Ç–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏–µ–π –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### ProductMatcher:
```javascript
class ProductMatcher {
  constructor() {
    this.fuse = null; // Fuse.js instance
  }

  async suggestProducts(query, limit = 5) {
    // –ù–µ—á–µ—Ç–∫–∏–π –ø–æ–∏—Å–∫
    const results = this.fuse.search(query);
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω–æ–Ω–∏–º–æ–≤
    const synonym = await ProductSynonym.findOne({ 
      where: { synonym: query.toLowerCase() }
    });
  }

  async learnSynonym(userQuery, selectedProduct) {
    // –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤—ã–±–æ—Ä–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    await ProductSynonym.upsert({
      synonym: userQuery.toLowerCase(),
      product_name: selectedProduct,
      usage_count: Sequelize.literal('usage_count + 1')
    });
  }
}
```

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –ù–µ—á–µ—Ç–∫–∏–π –ø–æ–∏—Å–∫ —Å Fuse.js
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏–Ω–æ–Ω–∏–º–æ–≤
- ‚úÖ –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã–±–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏—è –æ–ø–µ—á–∞—Ç–æ–∫
- ‚úÖ Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏

### –≠—Ç–∞–ø 5: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ Telegram –±–æ—Ç–µ.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:
1. –í—ã–±–æ—Ä —Ä–æ–ª–∏ (—Ä–µ—Å—Ç–æ—Ä–∞–Ω/–º–µ–Ω–µ–¥–∂–µ—Ä/–∑–∞–∫—É–ø—â–∏–∫)
2. –î–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ - –≤—ã–±–æ—Ä –∏–ª–∏ –∑–∞–ø—Ä–æ—Å —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ
3. –í–≤–æ–¥ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º

#### RegistrationRequest:
```javascript
{
  telegram_id: STRING,
  requested_role: ENUM,
  restaurant_name: STRING,
  contact_phone: STRING,
  status: ENUM('pending', 'approved', 'rejected')
}
```

#### Middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
```javascript
const authMiddleware = async (ctx, next) => {
  const user = await User.findOne({
    where: { telegram_id: ctx.from.id }
  });
  
  if (!user && !isPublicCommand(ctx)) {
    return ctx.reply('–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /start');
  }
  
  ctx.user = user;
  return next();
};
```

### –≠—Ç–∞–ø 6: –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫

**–ó–∞–¥–∞—á–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### –°—Ü–µ–Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞:
```javascript
const addProductScene = new Scenes.BaseScene('add_product');

// –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å:
// 1. –ü–æ–∏—Å–∫ –ø—Ä–æ–¥—É–∫—Ç–∞
// 2. –í—ã–±–æ—Ä –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
// 3. –í–≤–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
// 4. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
```

#### OrderService:
```javascript
class OrderService {
  static async createOrder(orderData) {
    // –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
    const transaction = await sequelize.transaction();
    
    const order = await Order.create(data, { transaction });
    await OrderItem.bulkCreate(items, { transaction });
    
    await transaction.commit();
  }
}
```

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –ü–æ—à–∞–≥–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –ü–æ–∏—Å–∫ —á–µ—Ä–µ–∑ ProductMatcher
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞

### –≠—Ç–∞–ø 7: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–æ–∫

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–æ–∫ –≤ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ –≤—Ä–µ–º—è.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### Settings –º–æ–¥–µ–ª—å:
```javascript
{
  key: STRING(100),
  value: TEXT,
  restaurant_id: INTEGER,
  value_type: ENUM('string', 'number', 'boolean', 'json', 'time')
}
```

#### OrderSchedulerService:
```javascript
class OrderSchedulerService {
  async scheduleRestaurantOrders(restaurantId) {
    const sendTime = await Settings.getAutoSendTime(restaurantId);
    const cronExpression = `${minutes} ${hours} * * *`;
    
    const task = cron.schedule(cronExpression, async () => {
      await this.processRestaurantOrders(restaurantId);
    });
  }

  async processRestaurantOrders(restaurantId) {
    // –ù–∞–π—Ç–∏ –≤—Å–µ —á–µ—Ä–Ω–æ–≤–∏–∫–∏
    const draftOrders = await Order.findAll({
      where: { restaurant_id, status: 'draft' }
    });
    
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å
    for (const order of draftOrders) {
      await order.update({ status: 'sent', sent_at: new Date() });
    }
    
    // –£–≤–µ–¥–æ–º–∏—Ç—å
    await this.sendNotifications(restaurantId, sentOrders);
  }
}
```

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- ‚úÖ –†—É—á–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–µ
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏

### –≠—Ç–∞–ø 8: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**–ó–∞–¥–∞—á–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞—è–≤–æ–∫ –æ—Ç —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### –°—Ü–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–∞:
```javascript
const processOrderScene = new Scenes.BaseScene('process_order');

// –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
// 1. –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–∑–∏—Ü–∏–π —Å —Ü–µ–Ω–∞–º–∏ –∏–∑ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã
// 2. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω
// 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
// 4. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
```

#### –ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏:
1. **–°–ø–∏—Å–æ–∫ –Ω–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫** - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º
2. **–î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä** - –ø–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–∑–∏—Ü–∏–π
3. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω** - —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –∏–∑ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã
4. **–ò—Ç–æ–≥–æ–≤–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** - —Å –ø–µ—Ä–µ—Å—á–µ—Ç–æ–º —Å—É–º–º

#### –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–∞:
- `draft` - —á–µ—Ä–Ω–æ–≤–∏–∫
- `sent` - –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
- `processing` - –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ
- `approved` - –æ–¥–æ–±—Ä–µ–Ω
- `rejected` - –æ—Ç–∫–ª–æ–Ω–µ–Ω
- `completed` - –∑–∞–≤–µ—Ä—à–µ–Ω

### –≠—Ç–∞–ø 9: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¢–û–†–ì-12 –≤ —Ñ–æ—Ä–º–∞—Ç–µ PDF.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### DocumentGenerator:
```javascript
class DocumentGenerator {
  async generateTorg12(orderId) {
    // 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞
    const order = await Order.findByPk(orderId, { include: [...] });
    
    // 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —à–∞–±–ª–æ–Ω–∞
    const data = await this.prepareTorg12Data(order);
    
    // 3. –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ HTML
    const html = await this.renderTemplate('torg12.hbs', data);
    
    // 4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF
    const pdfBuffer = await this.generatePDF(html);
    
    // 5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞
    return { fileName, filePath, buffer };
  }
}
```

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¢–û–†–ì-12 –ø–æ —à–∞–±–ª–æ–Ω—É
- ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤
- ‚úÖ –†–∞—Å—á–µ—Ç –ù–î–°
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ —á–∞—Ç –±–æ—Ç–∞
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ email
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

### –≠—Ç–∞–ø 10: –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –∑–∞–∫—É–ø—â–∏–∫–æ–≤

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è –∑–∞–∫—É–ø—â–∏–∫–æ–≤ –ø–æ –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏ –∑–∞—è–≤–æ–∫ –æ—Ç –≤—Å–µ—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### Purchase –º–æ–¥–µ–ª—å:
```javascript
{
  consolidated_product_id: STRING(500),
  product_name: STRING(300),
  unit: STRING(20),
  total_quantity: DECIMAL(10, 3),
  purchased_quantity: DECIMAL(10, 3),
  total_price: DECIMAL(10, 2),
  unit_price: DECIMAL(10, 2),
  buyer_id: INTEGER,
  status: ENUM('pending', 'partial', 'completed', 'cancelled'),
  orders_data: JSON,
  notes: TEXT
}
```

#### –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –≤ OrderService:
```javascript
static async getConsolidatedOrders() {
  // –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
  const orders = await Order.findAll({
    where: { status: 'approved' },
    include: [OrderItem, Restaurant]
  });
  
  // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º
  const consolidated = {};
  orders.forEach(order => {
    order.items.forEach(item => {
      const key = `${item.product_name}_${item.unit}`;
      // –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤
      // –ü–æ–¥—Å—á–µ—Ç —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
      // –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã
    });
  });
  
  return Object.values(consolidated);
}
```

#### –°—Ü–µ–Ω–∞ –∑–∞–∫—É–ø–∫–∏ (purchaseScene):
```javascript
// –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å:
// 1. –ü–æ–∫–∞–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–¥—É–∫—Ç–µ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏
// 2. –í–≤–æ–¥ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—É–ø–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
// 3. –í–≤–æ–¥ –æ–±—â–µ–π —Å—É–º–º—ã –∑–∞–∫—É–ø–∫–∏
// 4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç —Ü–µ–Ω—ã –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
// 5. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ –∑–∞–∫–∞–∑–∞–º
```

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –ö–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏–∑ –≤—Å–µ—Ö –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–∫—É–ø–æ–∫ —Å –∏—Å—Ç–æ—Ä–∏–µ–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–Ω –ø–æ –∑–∞–∫–∞–∑–∞–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —á–∞—Å—Ç–∏—á–Ω—ã—Ö –∑–∞–∫—É–ø–æ–∫
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫—É–ø–æ–∫ –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º

### –≠—Ç–∞–ø 11: –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω–∞–º–∏ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å

**–ó–∞–¥–∞—á–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω–∞–º–∏ –∏ –±–∞–∑–æ–≤—É—é –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### PriceHistory –º–æ–¥–µ–ª—å:
```javascript
{
  product_name: STRING(300),
  unit: STRING(20),
  price_type: ENUM('purchase', 'sale', 'suggested'),
  price: DECIMAL(10, 2),
  source: ENUM('manual', 'purchase', 'order', 'import'),
  source_id: INTEGER,
  user_id: INTEGER,
  restaurant_id: INTEGER,
  notes: TEXT,
  effective_date: DATE
}
```

#### AnalyticsService:
```javascript
class AnalyticsService {
  // –†–∞—Å—á–µ—Ç –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∞
  static async calculateProductMargin(productName, unit, restaurantId)
  
  // –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –ø—Ä–æ–¥—É–∫—Ç–∞
  static async getProductPriceHistory(productName, unit, daysBack)
  
  // –û—Ç—á–µ—Ç –ø–æ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
  static async getProfitabilityReport(restaurantId, dateFrom, dateTo)
  
  // –ê–Ω–∞–ª–∏–∑ –ø–ª–∞–Ω–æ–≤–æ–π vs —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏
  static async getOrderCostAnalysis(orderId)
  
  // –¢–æ–ø –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º
  static async getTopProducts(criteria, limit, dateFrom, dateTo)
  
  // –ê–Ω–∞–ª–∏–∑ –¥–∏–Ω–∞–º–∏–∫–∏ —Ü–µ–Ω
  static async getPriceTrends(productName, unit, daysBack)
}
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω –≤ Google Sheets:
```javascript
// GoogleSheetsService –¥–æ–ø–æ–ª–Ω–µ–Ω –º–µ—Ç–æ–¥–∞–º–∏:
async updatePricesFromPurchases(daysBack) {
  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö –∑–∞–∫—É–ø–æ—á–Ω—ã—Ö —Ü–µ–Ω
  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω –≤ Google Sheets
  // –†–∞—Å—á–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö —Ü–µ–Ω –ø—Ä–æ–¥–∞–∂–∏
}

async getSuggestedSalePrice(productName, unit, markupPercent) {
  // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–∫—É–ø–æ—á–Ω–æ–π —Ü–µ–Ω—ã
  // –†–∞—Å—á–µ—Ç —Å —É—á–µ—Ç–æ–º –Ω–∞—Ü–µ–Ω–∫–∏
}
```

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –∑–∞–∫—É–ø—â–∏–∫–æ–≤:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ü–µ–Ω –∑–∞–∫—É–ø–∫–∏ –≤ –∏—Å—Ç–æ—Ä–∏—é
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω –ø—Ä–æ–¥—É–∫—Ç–∞
- ‚úÖ –†–∞—Å—á–µ—Ç –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –ø—Ä–æ–¥—É–∫—Ç—É

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤:
- ‚úÖ –û—Ç—á–µ—Ç –ø–æ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ —Å —Ç–æ–ø-10 –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–∫–∞–∑–∞: –ø–ª–∞–Ω–æ–≤–∞—è vs —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω –≤ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–∫—É–ø–æ–∫
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω —Å —Ç—Ä–µ–Ω–¥–∞–º–∏
- ‚úÖ –¢–æ–ø –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ø–æ –≤—ã—Ä—É—á–∫–µ/–∫–æ–ª–∏—á–µ—Å—Ç–≤—É/–∑–∞–∫–∞–∑–∞–º

#### –ö–æ–º–∞–Ω–¥—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:
- `/price_history [–ø—Ä–æ–¥—É–∫—Ç]` - –∏—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω
- `/profitability` - –æ—Ç—á–µ—Ç –ø–æ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
- `/update_prices` - –æ–±–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—ã –≤ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–µ
- `/order_analysis [–Ω–æ–º–µ—Ä]` - –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞

### –≠—Ç–∞–ø 12: Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### EmailService:
```javascript
class EmailService {
  constructor() {
    this.transporter = null;
    this.templates = {};
  }

  async initialize() {
    const smtpSettings = await this.getSmtpSettings();
    if (!smtpSettings.host || !smtpSettings.user) {
      return false; // Email –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
    }
    
    this.transporter = nodemailer.createTransport({
      host: smtpSettings.host,
      port: smtpSettings.port || 587,
      secure: smtpSettings.secure || false,
      auth: {
        user: smtpSettings.user,
        pass: smtpSettings.pass
      }
    });
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤
    await this.loadTemplates();
    return true;
  }

  async sendTemplatedEmail(templateName, data, to, subject) {
    const template = this.templates[templateName];
    const html = template(data);
    
    return await this.sendEmail({
      to,
      subject,
      html
    });
  }

  // –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã
  async sendTorg12(order, pdfPath, recipientEmail)
  async sendNewOrderNotification(order)
  async sendDailyReport(orders, recipientEmail)
  async sendPriceChangeNotification(changes, recipientEmail)
}
```

#### Email —à–∞–±–ª–æ–Ω—ã (Handlebars):

1. **torg12.hbs** - –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø–∏—Å—å–º–æ —Å –≤–ª–æ–∂–µ–Ω–∏–µ–º –¢–û–†–ì-12
```handlebars
<div style="font-family: Arial, sans-serif;">
  <h2>–¢–û–†–ì-12 ‚Ññ{{order.order_number}}</h2>
  <p>–î–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –∑–∞–∫–∞–∑–∞ –æ—Ç {{restaurantName}}</p>
  <p>–°—É–º–º–∞: {{totalAmount}} ‚ÇΩ</p>
  <!-- –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞ -->
</div>
```

2. **new_order.hbs** - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–µ
```handlebars
<h3>–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ ‚Ññ{{orderNumber}}</h3>
<p>–û—Ç: {{restaurantName}}</p>
<p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∑–∏—Ü–∏–π: {{itemsCount}}</p>
<!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ -->
```

3. **daily_report.hbs** - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç
```handlebars
<h2>–û—Ç—á–µ—Ç –∑–∞ {{date}}</h2>
<h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</h3>
<ul>
  <li>–ù–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫: {{stats.new}}</li>
  <li>–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {{stats.processed}}</li>
  <li>–û–±—â–∞—è —Å—É–º–º–∞: {{stats.totalAmount}} ‚ÇΩ</li>
</ul>
<!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
```

4. **price_changes.hbs** - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–Ω
```handlebars
<h3>–ò–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω –Ω–∞ {{date}}</h3>
<table>
  {{#each changes}}
  <tr>
    <td>{{productName}}</td>
    <td>{{oldPrice}} ‚Üí {{newPrice}}</td>
    <td>{{changePercent}}%</td>
  </tr>
  {{/each}}
</table>
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ email –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ Settings –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è email –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```javascript
// –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –≤ Settings
Settings.getEmailSettings = async function() {
  const settings = {
    smtp_host: await this.getValue('smtp_host'),
    smtp_port: await this.getValue('smtp_port'),
    smtp_secure: await this.getValue('smtp_secure'),
    smtp_user: await this.getValue('smtp_user'),
    smtp_pass: await this.getValue('smtp_pass'),
    smtp_from: await this.getValue('smtp_from'),
    accountant_email: await this.getValue('accountant_email'),
    manager_emails: await this.getValue('manager_emails'),
    notification_emails: await this.getValue('notification_emails')
  };
  return settings;
};
```

#### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ email:

1. **–ú–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫ email** (emailSettings.js)
```javascript
const emailSettingsMenu = async (ctx) => {
  const keyboard = Markup.keyboard([
    ['üìß SMTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏', 'üìÆ Email –∞–¥—Ä–µ—Å–∞'],
    ['üß™ –¢–µ—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è', 'üì® –¢–µ—Å—Ç –ø–∏—Å—å–º–∞'],
    ['üîô –ù–∞–∑–∞–¥']
  ]).resize();
  // –ü–æ–∫–∞–∑ –º–µ–Ω—é
};
```

2. **–°—Ü–µ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SMTP** (editSmtpScene.js)
```javascript
// –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:
// 1. –í–≤–æ–¥ —Ö–æ—Å—Ç–∞ (smtp.gmail.com)
// 2. –í—ã–±–æ—Ä –ø–æ—Ä—Ç–∞ (587/465/25)
// 3. Email –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
// 4. –ü–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
// 5. Email –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
// 6. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
```

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã:

1. **–û—Ç–ø—Ä–∞–≤–∫–∞ –¢–û–†–ì-12 –Ω–∞ email:**
```javascript
// –í documents.js
const result = await emailService.sendTorg12(order, filePath, recipientEmail);
```

2. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∑–∞—è–≤–∫–∞—Ö:**
```javascript
// –í OrderService
if (await emailService.isConfigured()) {
  await emailService.sendNewOrderNotification(order);
}
```

3. **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã:**
```javascript
// –í OrderSchedulerService
async sendDailyReports() {
  const orders = await this.getTodayOrders();
  const managers = await Settings.getValue('manager_emails');
  if (managers) {
    await emailService.sendDailyReport(orders, managers);
  }
}
```

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ SMTP –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞ (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ Gmail, Yandex, Mail.ru)
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –¢–û–†–ì-12 —Å PDF –≤–ª–æ–∂–µ–Ω–∏–µ–º
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∑–∞—è–≤–∫–∞—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º
- ‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –ø–æ –∑–∞–∫–∞–∑–∞–º
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–Ω
- ‚úÖ –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–∏—Å–µ–º
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–∏—Å–µ–º
- ‚úÖ Graceful fallback –µ—Å–ª–∏ email –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ HTML —à–∞–±–ª–æ–Ω—ã –ø–∏—Å–µ–º
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π

### –≠—Ç–∞–ø 13: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å

**–ó–∞–¥–∞—á–∞:** –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
- `/admin_panel` - –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `/users` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `/restaurants` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º–∏
- `/settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
- `/backup` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –ë–î
- `/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- `/logs` - –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:

1. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:**
   - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

2. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º–∏:**
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
   - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
   - –ê–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
   - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º

3. **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
   - –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –ë–î —Å –∞—Ä—Ö–∏–≤–∞—Ü–∏–µ–π
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –±—ç–∫–∞–ø–æ–≤ (—Ö—Ä–∞–Ω—è—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10)
   - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ª–æ–≥–æ–≤
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

#### –°—Ü–µ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
- `addAdminScene` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `addRestaurantScene` - –ø–æ—à–∞–≥–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
- `editRestaurantScene` - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞

#### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞—â–∏—â–µ–Ω—ã middleware `requireAdmin`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

### –≠—Ç–∞–ø 14: –°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ó–∞–¥–∞—á–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

#### 1. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (Winston):

```javascript
// –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ logger.js:
- –†–æ—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤ (daily-rotate-file)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –ø–æ —É—Ä–æ–≤–Ω—è–º (error, info, debug)
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤ (14 –¥–Ω–µ–π)
- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π:
  - logCommand() - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥
  - logAction() - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - logPerformance() - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  - logError() - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
```

#### 2. –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫:

```javascript
// errorHandler.js –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã –æ—à–∏–±–æ–∫ (ValidationError, AuthError, DatabaseError –∏ —Ç.–¥.)
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–ª—è Telegram –±–æ—Ç–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ –æ—à–∏–±–æ–∫
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö
- –û–±–µ—Ä—Ç–∫–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ü–µ–Ω–∞–º–∏
```

#### 3. –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (MonitoringService):

**–ú–µ—Ç—Ä–∏–∫–∏ Prometheus:**
- –°—á–µ—Ç—á–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
- –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Ç–∏–ø–∞–º
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –†–∞–∑–º–µ—Ä—ã –æ—á–µ—Ä–µ–¥–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

#### 4. Health Check —Å–µ—Ä–≤–∏—Å:

**Endpoints:**
- `/health` - –ø–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
- `/liveness` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Å–µ—Ä–≤–∏—Å –∂–∏–≤
- `/readiness` - –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫
- `/metrics` - –º–µ—Ç—Ä–∏–∫–∏ Prometheus
- `/info` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ

**–ü—Ä–æ–≤–µ—Ä–∫–∏:**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- –°—Ç–∞—Ç—É—Å –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (Google Sheets, Email)
- –ù–∞–ª–∏—á–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

#### 5. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:

**Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö:**
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–¥–∫–∏ (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∫–æ–º–∞–Ω–¥–∞)

#### 6. Graceful Shutdown:

**–ü—Ä–æ—Ü–µ—Å—Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:**
1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ isShuttingDown
2. –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ health check
3. –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–∫—É—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (5 —Å–µ–∫)
4. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
5. –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –ë–î
6. –§–∏–Ω–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ index.js:

- –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ bot.catch()
- –û–±–µ—Ä—Ç–∫–∞ –≤—Å–µ—Ö —Å—Ü–µ–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ó–∞–ø—É—Å–∫ health check —Å–µ—Ä–≤–µ—Ä–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ SIGINT/SIGTERM

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

```env
# Health check
HEALTH_CHECK_PORT=3000

# Logging
LOG_LEVEL=info
```

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫
- ‚úÖ –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–æ–π
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ Health check endpoints –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º
- ‚úÖ Graceful shutdown –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ–µ–≤

## API –∏ –∫–æ–º–∞–Ω–¥—ã

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- `/start` - –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `/profile` - –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è
- `/help` - –ø–æ–º–æ—â—å

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤:
- `/restaurant_menu` - –º–µ–Ω—é —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
- `/create_order` - —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑
- `/my_orders` - –º–æ–∏ –∑–∞–∫–∞–∑—ã
- `/set_send_time` - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Ä–µ–º—è –∞–≤—Ç–æ–æ—Ç–ø—Ä–∞–≤–∫–∏
- `/send_now` - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑—ã —Å–µ–π—á–∞—Å

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤:
- `/manager_menu` - –º–µ–Ω—é –º–µ–Ω–µ–¥–∂–µ—Ä–∞
- `/pending_orders` - –Ω–æ–≤—ã–µ –∑–∞—è–≤–∫–∏
- `/process_order_ID` - –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–∫–∞–∑
- `/generate_torg12_ID` - —Å–æ–∑–¥–∞—Ç—å –¢–û–†–ì-12
- `/documents_menu` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
- `/price_history [–ø—Ä–æ–¥—É–∫—Ç]` - –∏—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω
- `/profitability` - –æ—Ç—á–µ—Ç –ø–æ —Ä–µ–Ω—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏
- `/update_prices` - –æ–±–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—ã –≤ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–µ
- `/order_analysis [–Ω–æ–º–µ—Ä]` - –∞–Ω–∞–ª–∏–∑ –∑–∞–∫–∞–∑–∞
- `/email_settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ email

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–∫—É–ø—â–∏–∫–æ–≤:
- `/procurement_menu` - –º–µ–Ω—é –∑–∞–∫—É–ø—â–∏–∫–∞
- `/consolidated_list` - –∫–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –∑–∞–∫—É–ø–∫–∏
- `/purchase_PRODUCT_ID` - –Ω–∞—á–∞—Ç—å –∑–∞–∫—É–ø–∫—É –ø—Ä–æ–¥—É–∫—Ç–∞
- `/continue_purchase_ID` - –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—É—é –∑–∞–∫—É–ø–∫—É

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env):
```bash
# Telegram Bot
BOT_TOKEN=your_bot_token

# Google Sheets
GOOGLE_SHEETS_ID=your_spreadsheet_id
GOOGLE_SERVICE_ACCOUNT_EMAIL=your_service_account@project.iam.gserviceaccount.com
GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"

# Email (SMTP)
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_SECURE=false
EMAIL_USER=your_email@gmail.com
EMAIL_PASS=your_app_password
EMAIL_FROM=noreply@yourdomain.com

# Email addresses (optional - can be configured via bot)
ACCOUNTANT_EMAIL=accountant@yourdomain.com
MANAGER_EMAILS=manager1@company.com,manager2@company.com
NOTIFICATION_EMAILS=notify@company.com

# Supplier (optional)
SUPPLIER_NAME=–û–û–û "–ü—Ä–æ–¥–¢–æ—Ä–≥"
SUPPLIER_INN=7734567890
SUPPLIER_KPP=773401001
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone <repository>
cd restaurant-procurement-bot

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env

# –ó–∞–ø—É—Å–∫
npm start

# –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev
```

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î:
–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è:
- –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
- –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –¢–µ—Å—Ç–æ–≤—ã–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∑–∞–¥–∞—á–∏:

1. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
   - –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Google Sheets

2. **–û—á–∏—Å—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**
   - –ö–æ–º–∞–Ω–¥–∞ `/cleanup_old_docs`
   - –£–¥–∞–ª—è–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π

3. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î**
   - SQLite —Ñ–∞–π–ª: `src/database/restaurant_procurement.db`
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

1. **–õ–æ–≥–∏**
   - `logs/error.log` - –æ—à–∏–±–∫–∏
   - `logs/combined.log` - –≤—Å–µ —Å–æ–±—ã—Ç–∏—è

2. **–ú–µ—Ç—Ä–∏–∫–∏**
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤
   - –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
   - –û—à–∏–±–∫–∏ API

### Troubleshooting:

1. **–ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –æ—à–∏–±–æ–∫
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å

2. **–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç Google Sheets**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ Service Account
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ID —Ç–∞–±–ª–∏—Ü—ã
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

3. **–ù–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è PDF**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É Puppeteer
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –ø–∞–ø–∫—É documents/
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –æ—à–∏–±–æ–∫

### –≠—Ç–∞–ø 13: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å

–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ —Å–∏—Å—Ç–µ–º–æ–π.

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **Middleware –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤** (auth.js)
```javascript
const requireAdmin = async (ctx, next) => {
  if (ctx.user.role !== 'admin') {
    return ctx.reply('üö´ –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω');
  }
  return next();
};
```

2. **–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥** (adminHandlers.js)

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:

##### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–µ–π –∏ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

##### 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º–∏:
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–∑–≤–∞–Ω–∏–µ, –∞–¥—Ä–µ—Å, —Ç–µ–ª–µ—Ñ–æ–Ω, email)
- –ê–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º

##### 3. –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π –ë–î (PostgreSQL)
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ª–æ–≥–æ–≤
- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã

#### –ö–æ–º–∞–Ω–¥—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/admin_panel` | –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ |
| `/users` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `/restaurants` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ |
| `/settings` | –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| `/backup` | –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –ë–î |
| `/stats` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã |
| `/user_ID` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º |
| `/restaurant_ID` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–º |

#### –°—Ü–µ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:

1. **addAdminScene** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
2. **addRestaurantScene** - –ø–æ—à–∞–≥–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
3. **editRestaurantScene** - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –º–µ–Ω—é:

```
üîß –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
‚îú‚îÄ‚îÄ üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ üìã –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ ‚è≥ –ó–∞—è–≤–∫–∏ –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
‚îÇ   ‚îî‚îÄ‚îÄ ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
‚îú‚îÄ‚îÄ üè¢ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ üìã –°–ø–∏—Å–æ–∫ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ä–µ—Å—Ç–æ—Ä–∞–Ω
‚îÇ   ‚îî‚îÄ‚îÄ üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞–º
‚îú‚îÄ‚îÄ ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ üìß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Email
‚îÇ   ‚îú‚îÄ‚îÄ ‚è∞ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ —Ä–æ–ª—è–º
‚îÇ   ‚îú‚îÄ‚îÄ –ó–∞–∫–∞–∑—ã –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
‚îÇ   ‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ üíæ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –ë–î
‚îî‚îÄ‚îÄ üìã –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã
```

#### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞** - –≤—Å–µ –∞–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã middleware
2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π** - –≤—Å–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ª–æ–≥–∏
3. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–æ–≤ –ë–î
4. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞** - –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å —Ä–æ–ª—å—é 'admin'

#### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:

```javascript
// –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞–º–ø–∞ PostgreSQL
const command = `PGPASSWORD="${password}" pg_dump -h ${host} -p ${port} -U ${username} -d ${database} -f ${backupFile}`;
// –ê—Ä—Ö–∏–≤–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é gzip
await execPromise(`gzip ${backupFile}`);
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (—Ö—Ä–∞–Ω—è—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10)
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
```bash
npm install --save-dev jest
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã:
```bash
npm test                # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
npm run test:watch      # –¢–µ—Å—Ç—ã –≤ —Ä–µ–∂–∏–º–µ watch
npm run test:coverage   # –¢–µ—Å—Ç—ã —Å –æ—Ç—á–µ—Ç–æ–º –ø–æ–∫—Ä—ã—Ç–∏—è
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ __tests__/
‚îÇ   ‚îú‚îÄ‚îÄ registration.test.js    # –¢–µ—Å—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ orderCreation.test.js   # –¢–µ—Å—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ orderProcessing.test.js # –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫–∞–∑–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ documentGeneration.test.js # –¢–µ—Å—Ç—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ buyerConsolidation.test.js # –¢–µ—Å—Ç—ã –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ integration.test.js     # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ fixtures/
‚îÇ   ‚îú‚îÄ‚îÄ testData.js            # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ seedTestData.js        # –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–î —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
‚îî‚îÄ‚îÄ setup.js                   # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

### –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

–ü—Ä–∏–º–µ—Ä unit-—Ç–µ—Å—Ç–∞:
```javascript
describe('OrderService', () => {
  test('–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞', async () => {
    const order = await OrderService.createOrder({
      restaurant_id: 1,
      user_id: 1,
      notes: '–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑'
    });
    
    expect(order).toBeTruthy();
    expect(order.status).toBe('draft');
    expect(order.order_number).toMatch(/^ORD-\d{8}-\d+$/);
  });
});
```

–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞:
```javascript
describe('–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∑–∞–∫–∞–∑–∞', () => {
  test('–û—Ç —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è', async () => {
    // 1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
    const order = await createTestOrder();
    
    // 2. –û—Ç–ø—Ä–∞–≤–∫–∞ –º–µ–Ω–µ–¥–∂–µ—Ä—É
    await OrderService.sendOrder(order.id);
    
    // 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º
    await processOrderByManager(order.id);
    
    // 4. –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –∑–∞–∫—É–ø—â–∏–∫–æ–º
    await consolidateOrder(order.id);
    
    // 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
    expect(order.status).toBe('completed');
  });
});
```

### –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

Mock –¥–∞–Ω–Ω—ã–µ –≤–∫–ª—é—á–∞—é—Ç:
- 2 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
- 5 —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∞–¥–º–∏–Ω, –º–µ–Ω–µ–¥–∂–µ—Ä, –∑–∞–∫—É–ø—â–∏–∫, 2 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤)
- 18 –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã

### –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏: 90%
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥: 80%
- –°–µ—Ä–≤–∏—Å—ã: 85%
- –£—Ç–∏–ª–∏—Ç—ã: 70%

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫—É–ø–∫–∞–º–∏ –¥–ª—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π –∫–ª—é—á–µ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 1–°
- –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- Multi-language –ø–æ–¥–¥–µ—Ä–∂–∫–∞